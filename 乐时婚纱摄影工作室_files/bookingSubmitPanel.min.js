Site.bookingSubmitPanel={};(function(y,E,i){var D=0,x=480,c=540,L=0,r=0,o={},K="",w,k="#module44",s=[],q=Fai.isIE6()||Fai.isIE7()||Fai.isIE8(),f=[],l={};E.dom={};var H=Fai.top._lcid==2052||Fai.top._lcid==1028;function v(){var T=(Fai.top.$("body").width()-r)/2;var R=(Fai.top.$("body").height()-L)/2;var S=[];S.push('<div class="fk-panelFormBooking" id="fk-bookingSubmitPanel" style="display:none;">');S.push('	<div class="f-contentBg J_contentBg"></div>');S.push('	<div class="f-content J_content" id="module44" style="width:'+r+"px; height:"+L+"px; top:"+R+"px; left:"+T+'px;">');S.push('		<div class="f-content-head">');S.push('			<div class="f-content-title">'+LS.onlineBooking+"</div>");S.push("		</div>");S.push('		<div class="f-innerContent" id="f-innerContent" style="overflow:hidden;"></div>');S.push('		<div class="bookingPanelMsg" id="bookingPanelMsg"></div>');S.push('		<a href="javascript:;" class="f-close J_close" onclick="return false;" title="关闭" hidefocus="true">关闭</a>');S.push("	</div>");S.push("</div>");return S}function O(){var S=[];if(!l.bookingOpen){var U=l.bookingClosedTip;if(Fai.top._manageMode){U+=("，"+l.pleaseClick+"<a target='_blank' href='javascript:Site.openMallEdit(\"manageFrameBookingEdit\");'>"+l.setUp+"</a>")}S.push('		<table class="bookingCloseTable" cellpadding="0" cellspacing="0">');S.push('			<tr><td style="text-align:center;">');S.push('				<div class="bookingClosePic"></div>');S.push('				<div class="bookingCloseTip">'+U+"</div>");S.push("			</td></tr>");S.push("		</table>")}else{var R=o.verticalShowType;var W=L-110;S.push('<div class="tableWrap" id="tableWrap" style="height:'+W+'px">');R?h(S):u(S);S.push("</div>")}var T=document.getElementById("tableWrap");if(T!=null){T.parentNode.removeChild(T)}var V=E.dom;V.innerContent.append(S.join(""));m()}function u(R){R.push('	<table class="bookingSubmitPanel_table" cellpadding="0" cellspacing="0">');R.push("		<tbody>");y.each(l.contentList,function(S,T){if(T.hide){return true}R.push('		<tr _contentId="'+T.id+'" _type="'+T.type+'">');if(T.headline==""){R.push('			<td class="column1"><div class="itemName" title="'+Fai.encodeHtml(T.name)+'">'+Fai.encodeHtml(T.name)+"</div></td>")}else{R.push('			<td class="column1"><div class="itemName" title="'+Fai.encodeHtml(T.headline)+'">'+Fai.encodeHtml(T.headline)+"</div></td>")}R.push('			<td class="column2">');R.push('				<div class="itemInput">');R.push(t(T));T.must&&T.type!=5?R.push('		<span class="inputMust">*</span>'):R.push("");R.push("				</div>");R.push("			</td>");R.push("		</tr>")});if(l.validation){R.push('		<tr _validationTr="true">');R.push('			<td class="column1"><div class="itemName">'+LS.loginDialogCaptcha+"</div></td>");R.push('			<td class="column2">');R.push('				<div class="itemInput">');R.push('					<div class="validateInputAndCode">');R.push('							<input id="bookingVolidationCode" class="voteCodeInputText" type="text" maxlength="4"/>');R.push('							<img alt="" class="voteCodePic" onclick="Site.changeCaptchaImg(this, 3)" title="'+LS.msgBoradChageValidateCode+'" id="memberCaptchaImg" src="validateCode.jsp?validateCodeRegType=3&Math.random()*1000">');R.push("					</div>");R.push('					<span class="inputMust">*</span>');R.push("				</div>");R.push("			</td>");R.push("		</tr>")}R.push('			<tr _submitTr="true">');R.push("				<td></td>");R.push('				<td class="column2">');R.push('					<div class="itemInput">');R.push('						<div class="addButtonshowType" id="bookingSubmitBtn">');R.push('							<div class="s_ibutton s_ibutton'+o[l.Def_BookingSubmit_BTN_STYLE]+'" type="botton" >');R.push('								<div class="left"></div>');R.push('								<div class="middle ">'+Fai.encodeHtml(l.buttonName)+"</div>");R.push('								<div class="right"></div>');R.push("							</div>");R.push("						</div>");R.push("					</div>");R.push("				</td>");R.push("			</tr>");R.push("		</tbody>");R.push("	</table>")}function h(R){R.push('	<table class="bookingSubmitPanel_table vertical" cellpadding="0" cellspacing="0">');R.push("		<tbody>");y.each(l.contentList,function(S,T){if(T.hide){return true}R.push('		<tr _contentId="'+T.id+'" _type="'+T.type+'">');R.push('			<td class="column1">');if(T.headline==""){R.push('				<div class="itemName" title="'+Fai.encodeHtml(T.name)+'">'+Fai.encodeHtml(T.name)+"</div>")}else{R.push('				<div class="itemName" title="'+Fai.encodeHtml(T.headline)+'">'+Fai.encodeHtml(T.headline)+"</div>")}R.push('				<div class="itemInput">');R.push(t(T));T.must&&T.type!=5?R.push('		<span class="inputMust">*</span>'):R.push("");R.push("				</div>");R.push("			</td>");R.push("		</tr>")});if(l.validation){R.push('		<tr _validationTr="true">');R.push('			<td class="column1">');R.push('				<div class="itemName">'+LS.loginDialogCaptcha+"</div>");R.push('				<div class="itemInput">');R.push('					<div class="validateInputAndCode">');R.push('							<input id="bookingVolidationCode" class="voteCodeInputText" type="text" maxlength="4"/>');R.push('							<img alt="" class="voteCodePic" onclick="Site.changeCaptchaImg(this, 3)" title="'+LS.msgBoradChageValidateCode+'" id="memberCaptchaImg" src="validateCode.jsp?validateCodeRegType=3&Math.random()*1000">');R.push("					</div>");R.push('					<span class="inputMust">*</span>');R.push("				</div>");R.push("			</td>");R.push("		</tr>")}R.push('			<tr _submitTr="true">');R.push('				<td class="column1">');R.push('					<div class="itemInput">');R.push('						<div class="addButtonshowType" id="bookingSubmitBtn">');R.push('							<div class="s_ibutton s_ibutton'+o[l.Def_BookingSubmit_BTN_STYLE]+'" type="botton" >');R.push('								<div class="left"></div>');R.push('								<div class="middle ">'+Fai.encodeHtml(l.buttonName)+"</div>");R.push('								<div class="right"></div>');R.push("							</div>");R.push("						</div>");R.push("					</div>");R.push("				</td>");R.push("			</tr>");R.push("		</tbody>");R.push("	</table>")}function t(ar){var ae=ar.id,U=ar.type,au=ar.name,ag=ar.must,ab=ar.input;X=(ar.placeholder==i)?"":ar.placeholder;var R=o[l.Def_BookingSubmit_ARRAY_STYLE],aa=l.Def_BookingSubmit_ARRAY_AUTO,S=l.Def_BookingSubmit_ARRAY_FIX,ak=o[l.Def_BookingSubmit_FIX_NUM];var Z=ab.split("\n");var ap="";var al=(ar.openAreaCode==i)?true:ar.openAreaCode;var X=(ar.placeholder==i)?"":ar.placeholder;if(U==l.Def_ContentList_Type_SINGLE_LINE){ap="<input class='singleLineTextInput bookingSingleText' id='bookingSingleText_"+ae+"' value='"+Fai.encodeHtml(typeof(l.memberName)=="undefined"||!ar.sys?"":l.memberName)+"' placeholder='"+Fai.encodeHtml(X)+"' type='text' maxlength='"+l.Def_LIMIT_INPUT_MAXLENTH+"'/>"}else{if(U==l.Def_ContentList_Type_MULTI_LINE){ap="<textArea class='bookingMultLine' id='bookingMultLine_"+ae+"' rows='3' placeholder='"+Fai.encodeHtml(X)+"' maxlength='"+l.Def_LIMIT_TEXTAREA_MAXLEN+"'/></textArea>"}else{if(U==l.Def_ContentList_Type_RADIO){var ao=[];y.each(Z,function(aw,ax){var av="radioR_"+ae+"_"+aw;if(aw%ak==0&&R==S){ao.push("<div class='arrangeFixBox'>")}ao.push("			<div class='singelChoice'>");if(q){ao.push("				<input type='radio' name='radioR_"+ae+"' id='"+av+"' value='"+Fai.encodeHtml(ax)+"' /><label for='"+av+"'>"+Fai.encodeHtml(ax)+"</label>")}else{ao.push(g("radioR_"+ae,ax))}ao.push("			</div>");if((aw%ak==ak-1||aw==Z.length-1)&&R==S){ao.push("</div>")}});ap=ao.join("")}else{if(U==l.Def_ContentList_Type_MULTIPLECHOICE){var ai=[];y.each(Z,function(aw,ax){var av="radioC_"+ae+"_"+aw;if(aw%ak==0&&R==S){ai.push("<div class='arrangeFixBox'>")}ai.push("<div class='multiChoice'>");if(q){ai.push("<input type='checkbox' name='radioC_"+ae+"' id='"+av+"' value='"+Fai.encodeHtml(ax)+"' /><label for='"+av+"'>"+Fai.encodeHtml(ax)+"</label>")}else{ai.push(a("radioC_"+ae,ax))}ai.push("</div>");if((aw%ak==ak-1||aw==Z.length-1)&&R==S){ai.push("</div>")}});ap=ai.join("")}else{if(U==l.Def_ContentList_Type_DROPDOWN){var T=[];if(q){T.push("<select class='dropDownSelect' id='dropDownSelect_"+ae+"'>");y.each(Z,function(av,aw){T.push("<option value='"+Fai.encodeHtml(aw)+"'>"+Fai.encodeHtml(aw)+"</option>")});T.push("</select>")}else{T.push("<div class='dropDownNewSelect' id='dropDownNewSelect_"+ae+"'></div>")}ap=T.join("")}else{if(U==l.Def_ContentList_Type_DESC){ap=Fai.encodeHtml(ab)}else{if(U==l.Def_ContentList_Type_DATE){var am=[];var at="bookingDate_"+ae;var an=ar.dateSetting;var ah=(an.type==i?0:an.type)==1;var Y={id:at,dateSetting:an};s.push(Y);am.push("<div class='siteFormMiddle'>");am.push("<input type='text' class='g_itext siteFormTimer "+(ah?"fk-startTime":"")+"' name='"+at+"' id='"+at+"' readonly />");if(ah){var aj="bookingDate_"+ae+"_end";var Y={id:aj,dateSetting:an};s.push(Y);am.push("<span class='fk-timeUtile'>"+LS.to+"</span>");am.push("<div class='fk-endTimeWrap'>");am.push("	<input type='text' class='fk-endTime g_itext siteFormTimer' name='"+aj+"' id='"+aj+"' readonly />");am.push("	<div _startId = '"+at+"' class='J_endTimeMask fk-endTimeMask'></div>");am.push("</div>")}am.push("</div>");ap=am.join("")}else{if(U==l.Def_ContentList_Type_FILE_UPLOAD){var ad=(ar.size>l.fileSizeLimit)?l.fileSizeLimit:ar.size;var V=[];if(!ar.isAllFile){var ac=(ar.dftl||"")+(ar.cftl||"");var W=ac.split(" ");y.each(W,function(ax,av){if(av.length>0){var aw="*."+av+";";V.push(aw)}})}else{V.push("*.*;")}f.push({itemId:ae,buttonValue:l.siteFormSelectFile,fileSize:ad,srcjQueryUploadPath:l.srcjQueryUploadPath,fileTypeList:V});var aq=[];aq.push("<input type='button' class='fileUploadBtn' id='bookingUploadBtn_"+ae+"' value='"+l.siteFormSelectFile+"'/>");aq.push("<div id='bookingUploadFile_"+ae+"' class='bookingUploadFile' _tmpFileId='' style='display:none; margin: 8px 0 0 20px;'>"+LS.siteFormSubmitNotSeletcFile+"</div>");aq.push("<span id='bookingUploadDESC_"+ae+"' style='margin: 8px 0 0 1%; display:inline-block;'><span class='siteFormFUDescIcons newSiteFormFUDescIcons'></span>"+l.siteFormFileSizeLimit+"："+ad+"M</span>");ap=aq.join("")}else{if(U==l.Def_ContentList_Type_PHONE){var af=[];if(al){if(q){af.push("<select class='phoneSelect' id='phoneSelect_"+ae+"'>");y.each(l.mobileCtNameList,function(av,aw){af.push("<option value='"+aw.ctName+"'>"+aw.ctShowName+aw.ctCode+"</option>")});af.push("</select>")}else{af.push("<div class='phoneNewSelect' id='phoneNewSelect_"+ae+"'></div>")}af.push("<input class='bookingPhoneWithCode' id='bookingPhoneNum_"+ae+"' value='"+Fai.encodeHtml(typeof(l.memberMobile)=="undefined"||!/^[0-9]*$/.test(l.memberMobile)||!ar.sys?"":l.memberMobile)+"' type='number' onkeyup='(this.v=function(){this.value=this.value.replace(/[^0-9-]+/,\"\");}).call(this)'  oninput='if(value.length>11)value=value.slice(0,11)'/>");ap=af.join("")}else{ap="<input class='singleLineTextInput bookingPhoneNoCode' id='bookingPhoneNum_"+ae+"' value='"+Fai.encodeHtml(typeof(l.memberMobile)=="undefined"||!/^[0-9]*$/.test(l.memberMobile)||!ar.sys?"":l.memberMobile)+"' type='text' onkeyup='(this.v=function(){this.value=this.value.replace(/[^0-9-]+/,\"\");}).call(this)' oninput='if(value.length>11)value=value.slice(0,11)'/>"}}else{if(U==l.Def_ContentList_Type_MAIL){ap="<input class='singleLineTextInput bookingMailInput' id='bookingMailInput_"+ae+"' type='text' name='input' />"}else{if(U==l.Def_ContentList_Type_IDENTITY){ap="<input class='singleLineTextInput bookingIdentityInput' id='bookingIdentityInput_"+ae+"' type='text' name='input' />"}else{if(U==l.Def_ContentList_Type_ADDRESS){ap=d(ar)}}}}}}}}}}}}return ap}function g(R,T){var S=[];S.push("	<span class='jz-radio R_"+R+"' inputName='"+R+"'>");S.push("		<span class='jz-radio-inner'></span>");S.push("		<input name='"+R+"' type='radio' class='jz-radio-input' value='"+Fai.encodeHtml(T)+"'/>");S.push("		<span class='labelForRadio'>"+Fai.encodeHtml(T)+"</span>");S.push("	</span>");return S.join("")}function a(R,T){y(k).off("click.ncheckbox").on("click.ncheckbox",".jz-checkBox",function(){if(y(this).hasClass("jz-check-checked")){y(this).removeClass("jz-check-checked");y(this).find(".jz-radio-input").attr("checked",false)}else{y(this).addClass("jz-check-checked");y(this).find(".jz-radio-input").attr("checked",true)}});var S=[];S.push("	<span class='bsCheckBox jz-checkBox C_"+R+"'>");S.push("		<span class='jz-checkBox-inner'></span>");S.push("		<input name='"+R+"' type='checkbox' style='display:none;' class='jz-radio-input' value='"+Fai.encodeHtml(T)+"'/>");S.push("		<span class='labelForCheckBox'>"+Fai.encodeHtml(T)+"</span>");S.push("	</span>");return S.join("")}function b(R){var S=function(U){var aa={container:y("body"),widgetClass:"selectTool",width:75,id:0,selectList:null,checkIndex:0,onchange:null,selectIcon:false,selectListHeight:185,selectItemHeight:28,enable:false},ac,ab="",Y,ag,ah,aj,Z,T,ad,ai,V,ak,ae;ac=this.opts=y.extend({},aa,U,true);if(ac.selectList.length<=0){return}if(ac.selectList.length*ac.selectItemHeight<ac.selectListHeight){ac.selectListHeight=ac.selectList.length*ac.selectItemHeight}Z=this;aj=ac.checkIndex;ab='<div class="fk-select-widget J_select_widget '+ac.widgetClass+'" id="J_'+ac.widgetClass+ac.id+'"><input class="seleInput" style="width:0; height:0; opacity:0; float:right;"/><div class="J_select_text_wrap f-select-text-wrap"><div class="f-select-text J_select_text '+(ac.enable?"selectEnable":"")+'" value="'+ac.selectList[aj].value+'">'+Fai.encodeHtml(ac.selectList[aj].content)+'</div><a class="f-select-arrow J_select_arrow"></a></div></div>';ac.container.append(ab);Y="";ag=this.widgetDom=ac.container.find("#J_"+ac.widgetClass+ac.id);E.dom.panel.find("#"+ac.container.attr("id")+"_select_list").remove();E.dom.panel.append('<ul class="f-select-list J_select_list" id="'+ac.container.attr("id")+'_select_list" style="height:'+ac.selectListHeight+'px; display:none;"></ul>');ah=E.dom.panel.find("#"+ac.container.attr("id")+"_select_list");y.each(ac.selectList,function(al,am){Y='<li class="f-select-item J_select_item'+(al==aj?" f-select-on ":"")+'" selectIndex="'+al+'" style="'+ac.selectItemHeight+'px;"><a class="J_radio_label" value="'+Fai.encodeHtml(am.value)+'">'+Fai.encodeHtml(am.content)+"</a></li>";ah.append(Y);Y=""});this.itemDom=ad=ah.find(".J_select_item");T=ac.selectItemHeight*ac.selectList.length;if(ac.selectIcon){var af="";af='<span class="J_select_img"></span>';this.itemDom.find(".J_radio_label").append(af)}if(ac.selectListHeight<T){ah.mCustomScrollbar({theme:"select-theme"})}ah.hide();ae=ag.find(".seleInput");ai=ag.find(".J_select_text");ad.off("click.selectTool").on("click.selectTool",function(){var ao=y(this).find(".J_radio_label"),an=ao.attr("value"),am=ao.text(),al=y(this).index();ac.checkIndex=al;ai.attr("value",an);ai.text(am);ah.slideUp(150);V.removeClass("f-select-ratate-arrow");ad.removeClass("f-select-on");y(this).addClass("f-select-on");if(!!ac.onchange){ac.onchange(y(this),al,Z)}});V=ag.find(".J_select_arrow");ak=ac.container.parents("body");ag.find(".J_select_text_wrap").off("click.selectTool").on("click.selectTool",function(al){if(ac.container.length!=1){return}if(ac.enable){return}if(!!ah.is(":hidden")){var am=ah.height();var an=ac.container.height()+ac.container.offset().top+10-y(window).scrollTop();if(an+am>Fai.top.$("body").height()){an=ac.container.offset().top-ac.container.height()-am+10-y(window).scrollTop()}ah.css({width:ac.container.width(),position:"absolute",top:an,left:ac.container.offset().left});ak.find(".J_select_widget .J_select_arrow").removeClass("f-select-ratate-arrow");ah.slideDown(150);V.addClass("f-select-ratate-arrow")}else{ah.slideUp(150);V.removeClass("f-select-ratate-arrow")}ae.focus();al.stopPropagation()});ae.on("blur",function(){ah.slideUp(150);ah.parent().find(".J_select_arrow").removeClass("f-select-ratate-arrow")});var W="";var X=navigator.userAgent.toLowerCase();if(/msie/.test(X)){W="-ms-"}else{if(/chrome/.test(X)||/safari/.test(X)||/yandex/.test(X)){W="-webkit-"}else{if(/mozilla/.test(X)){W="-moz-"}else{if(/opera/.test(X)){W="-o-"}else{if(/konqueror/.test(X)){W="-khtml-"}else{W=""}}}}}ah.css(W+"user-select","none").attr("unselectable","on").on("selectstart mousedown",false)};y.extend(S.prototype,{selectValue:function(T){this.itemDom.each(function(){var U=y(this).find(".J_radio_label").attr("value");if(T==U){y(this).trigger("click");return}})},getValue:function(){return this.widgetDom.find(".J_select_text").attr("value")},destroy:function(){this.widgetDom.find(".J_select_list").mCustomScrollbar("destroy");this.opts=null;this.widgetDom=null},hideList:function(){var T=this.widgetDom.find(".J_select_widget");T.slideUp(150);T.parent().find(".J_select_arrow").removeClass("f-select-ratate-arrow")}});return new S(R)}function d(T){var R=[],W=T.id,S=T.openMunicipalCode;if(q){R.push("<select class='addrSelect proSelect' id='proSelect_"+W+"' _contentId='"+W+"'>");var V;var U;if(H){V=site_cityUtil.getProvince()}else{V=site_cityUtil.getProvinceEn()}R.push("<option _val='-1' value='-1'>"+l.siteFormPleaseSelect+"</option>");y.each(V,function(X,Y){if(H){R.push("<option _val='"+Y.name+"' value='"+Y.id+"'>"+site_cityUtil.simpleCityNameStr(Y.name)+"</option>")}else{R.push("<option _val='"+Y.name+"' value='"+Y.id+"'>"+site_cityUtil.simpleCityNameStrEn(Y.name)+"</option>")}});R.push("</select>");R.push("<select class='addrSelect citySelect' id='citySelect_"+W+"' _contentId='"+W+"' disabled>");R.push("<option _val='-1' value='-1'>"+l.siteFormPleaseSelect+"</option>");R.push("</select>");if(S){R.push("<select class='addrSelect countySelect' id='countySelect_"+W+"' disabled>");R.push("<option _val='-1' value='-1'>"+l.siteFormPleaseSelect+"</option>");R.push("</select>")}return R.join("")}else{R.push("<div class='addrNewSelect proNewSelect' id='proNewSelect_"+W+"'></div>");R.push("<div class='addrNewSelect cityNewSelect' id='cityNewSelect_"+W+"'></div>");if(S){R.push("<div class='addrNewSelect countyNewSelect' id='countyNewSelect_"+W+"'></div>")}return R.join("")}}function z(V){var W=V.fileSize;var U=V.itemId;var ag=V.moduleId;var S=V.fileTypeList;var ad=V.buttonValue;var R=V.isModuleButtonStyle;var ab=V.showType;var Y=V.srcjQueryUploadPath;var af;var ai;var T=document.documentElement||document.body;var X=y("#bookingUploadBtn_"+U);var Z=X.width();var ah;if(!Fai.isIE()){var ac={auto:true,fileTypeExts:S.join(""),multi:true,fileSizeLimit:W*1024*1024,fileSplitSize:20*1024*1024,breakPoints:true,isBurst:false,saveInfoLocal:false,showUploadedPercent:true,showUploadedSize:true,removeTimeout:9999999,post_params:{app:21,type:0,fileUploadLimit:W},getFileSizeUrl:"/ajax/advanceUpload.jsp?cmd=_getUploadSize",uploader:"/ajax/advanceUpload.jsp?cmd=_mobiupload",onUploadSuccess:function(aj,al){var ak=y.parseJSON(al);if(ak.success){Fai.ing(Fai.format(LS.siteFormSubmitFileUploadSucess,Fai.encodeHtml(aj.name)),true);n("upload",ak,ag,U)}else{Fai.ing("文件:"+aj.name+"，"+ak.msg)}},onUploadError:function(aj,ak){y("#progressBody_"+aj.id).remove();y("#progressWrap_"+aj.id).remove();Fai.ing(Fai.format(LS.siteFormSubmitFileUploadSvrBusy,Fai.encodeHtml(aj.name)))}};function ae(){af=X.uploadify(ac);X.on("click",function(){X.find("a")[0].click()})}if(typeof X.uploadify=="function"){ae()}else{ai=document.createElement("script");ai.src=Y;ai.type="text/javascript";T.appendChild(ai);ai.onload=function(){ae()}}}else{var aa={file_post_name:"Filedata",upload_url:"/ajax/upsiteimg_h.jsp",button_placeholder_id:"bookingUploadBtn_"+U,file_size_limit:W+"MB",button_image_type:6,file_queue_limit:1,requeue_on_error:false,button_height:32,button_width:128,button_text:"<span class='fk_btText'>"+ad+"</span>",button_text_style:".fk_btText{text-align:center; font-family: 微软雅黑; color: #333;}",button_text_top_padding:6,post_params:{ctrl:"Filedata",app:21,type:0,isSiteForm:true},file_types:S.join(""),file_dialog_complete_handler:function(aj){this._allSuccess=false;this.startUpload()},file_queue_error_handler:function(ak,aj,al){switch(aj){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:Fai.ing(LS.siteFormSubmitCheckFileSizeErr,true);break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:Fai.ing(LS.siteFormSubmitFileUploadNotAllow,true);break;case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:Fai.ing(Fai.format(LS.siteFormSubmitFileUploadOneTimeNum,"一"),true);break;default:Fai.ing(LS.siteFormSubmitFileUploadReSelect,true);break}},upload_success_handler:function(ak,aj){var al=jQuery.parseJSON(aj);this._allSuccess=al.success;this._sysResult=al.msg;if(al.success){Fai.ing(Fai.format(LS.siteFormSubmitFileUploadSucess,Fai.encodeHtml(ak.name)),true);n("upload",al,ag,U)}else{Fai.ing(LS.siteFormSubmitFileUploadFile+ak.name+"，"+al.msg)}},upload_error_handler:function(ak,aj,al){if(aj==-280){Fai.ing(LS.siteFormSubmitFileUploadFileCancle,false)}else{if(aj==-270){Fai.ing(Fai.format(LS.siteFormSubmitFileUploadFileExist,Fai.encodeHtml(ak.name)),true)}else{Fai.ing(Fai.format(LS.siteFormSubmitFileUploadSvrBusy,Fai.encodeHtml(ak.name)))}}},upload_complete_handler:function(aj){if(aj.filestatus==SWFUpload.FILE_STATUS.COMPLETE){setTimeout(function(){af.startUpload()},af.upload_delay)}else{if(aj.filestatus==SWFUpload.FILE_STATUS.ERROR){Fai.ing(Fai.format(LS.siteFormSubmitFileUploadSvrBusy,Fai.encodeHtml(aj.name)))}}},upload_start_handler:function(aj){Fai.enablePopupWindowBtn(0,"save",false);Fai.ing(LS.siteFormSubmitFileUploadPrepare,false)},view_progress:function(aj,am,al,ak){Fai.ing(LS.siteFormSubmitFileUploadIng+ak+"%",false)}};af=SWFUploadCreator.create(aa)}}function n(af,ab,ag,Y){if(af=="upload"){var V=ab.id;var ad=ab.name;var T=ab.type;var aa=ab.size;var Z=ab.path;var U=ab.createTime;var R=ab.groupId;var W="";var S=100;var ac=100;var X=ab.fileId;var ae=y("#bookingUploadFile_"+Y);y("#bookingUploadDESC_"+Y).hide();ae.css("display","inline-block");ae.html(ad);ae.attr("_tmpFileId",V).attr("_tmpFileName",ad).attr("title",ad).attr("_fileId",X)}}function Q(R){var S=[];S.push("pid="+D);S.push("&cmd=getPanelData");S.push("&_colId="+Fai.top._colId);S.push("&_extId="+Fai.top._extId);y.ajax({type:"get",cache:false,url:Site.genAjaxUrl("booking_h.jsp?")+S.join(""),error:function(){Fai.ing("服务繁忙，请稍候重试",false)},success:function(U){var T=y.parseJSON(U);if(T.success){l=T.pageData;K=l.css;o=l.moduleInfo;if(Fai.top._manageMode){w=l.itemList}O();j()}else{Fai.ing("获取数据失败",false)}}})}function p(){var an=l.contentList,aq=l.Def_LIMIT_INPUT_MAXLENTH,X=l.Def_LIMIT_TEXTAREA_MAXLEN,ac=[],ap=[],ag=true;if(an.length<1){return}for(var ah=0;ah<an.length;ah++){var ar=an[ah];id=ar.id,name=ar.name,must=ar.must,type=ar.type,size=ar.size,openAreaCode=ar.openAreaCode,tmpItemContentList={id:id,type:type,must:must};if(type==0){var al=y.trim(y("#bookingSingleText_"+id).val());if(must&&al==""){G(Fai.format(LS.siteFormSubmitInputIsEmpty,Fai.encodeHtml(name)));ag=false;return false}if(al.length>aq){G(Fai.format(LS.siteFormSubmitInputMaxLength,Fai.encodeHtml(name),aq));ag=false;return false}tmpItemContentList.val=al}else{if(type==1){var S=y.trim(y("#bookingMultLine_"+id).val());if(must&&S==""){G(Fai.format(LS.siteFormSubmitInputIsEmpty,Fai.encodeHtml(name)));ag=false;return false}if(S.length>X){G(Fai.format(LS.siteFormSubmitInputMaxLength,Fai.encodeHtml(name),X));ag=false;return false}tmpItemContentList.val=S}else{if(type==2){if(must&&y("input[name=radioR_"+id+"]:checked").length==0){G(Fai.format(LS.siteFormSubmitCheckIsEmpty,Fai.encodeHtml(name)));ag=false;return false}if(y("input[name=radioR_"+id+"]:checked").length>0){tmpItemContentList.val=y("input[name=radioR_"+id+"]:checked").first().val()}else{tmpItemContentList.val=""}}else{if(type==3){if(must&&y("input[name=radioC_"+id+"]:checked").length==0){G(Fai.format(LS.siteFormSubmitCheckIsEmpty,Fai.encodeHtml(name)));ag=false;return false}var af=[];y("input[name=radioC_"+id+"]:checked").each(function(at,au){af.push(y(this).val())});tmpItemContentList.val=af.join("\n")}else{if(type==4){var R=y("#dropDownSelect_"+id+" option:selected").val();if(!q){R=y("#dropDownNewSelect_"+id).find(".f-select-text").attr("value")}tmpItemContentList.val=R}else{if(type==5){continue}else{if(type==6){var al=y("#bookingDate_"+id).val(),V=ar.dateSetting?ar.dateSetting.type:0,aa=V==1?y("#bookingDate_"+id+"_end").val():"";if(must&&al==""){G(Fai.format(LS.siteFormSubmitCheckIsEmpty,Fai.encodeHtml(name)));ag=false;return false}if(must&&V==1&&aa==""){G(Fai.format(LS.siteFormSubmitCheckIsEmpty,Fai.encodeHtml(name)));ag=false;return false}if(V==1){if(y.trim(al)||y.trim(aa)){al=al+" 至 "+aa}else{al=""}}tmpItemContentList.val=al}else{if(type==7){var U=y("#bookingUploadFile_"+id);var ak={};if(must&&U.attr("_tmpFileId")==""){G(Fai.format(LS.siteFormSubmitCheckHasFileUpload,Fai.encodeHtml(name)));ag=false;return false}if(U.attr("_tmpFileId")==""){tmpItemContentList.val=""}else{tmpItemContentList.val=U.attr("_fileId");ak.tmpFileName=U.attr("_tmpFileName");ak.fileId=tmpItemContentList.val;ak.tmpFileId=U.attr("_tmpFileId");ap.push(ak)}}else{if(type==8){var am=y("#bookingPhoneNum_"+id).val();if(must&&am==""){G(Fai.format(LS.siteFormSubmitInputIsEmpty,Fai.encodeHtml(name)));ag=false;return false}if(must&&!Fai.isNationMobile(am)){G(Fai.format(LS.memberProfileItemCorrect,Fai.encodeHtml(name)));ag=false;return false}if(openAreaCode){var T="";if(q){T=y("#phoneSelect_"+id).val()}else{T=y("#phoneNewSelect_"+id).find(".f-select-text").attr("value")}if(y.trim(am)){tmpItemContentList.val=T+am}else{tmpItemContentList.val=""}}else{tmpItemContentList.val=am}}else{if(type==9){var ai=y("#bookingMailInput_"+id).val();if(must&&ai==""){G(Fai.format(LS.siteFormSubmitInputIsEmpty,Fai.encodeHtml(name)));ag=false;return false}if(must&&!Fai.isEmail(ai)){G(Fai.format(LS.memberSignupUserAddItemCorrect,Fai.encodeHtml(name)));ag=false;return false}tmpItemContentList.val=ai}else{if(type==10){var ad=y("#bookingIdentityInput_"+id).val();if(must&&ad==""){G(Fai.format(LS.siteFormSubmitInputIsEmpty,Fai.encodeHtml(name)));ag=false;return false}if(must&&!Fai.isCardNo(ad)){G(Fai.format(LS.memberSignupUserAddItemCorrect,Fai.encodeHtml(name)));ag=false;return false}tmpItemContentList.val=ad}else{if(type==11){var ab=y("#proSelect_"+id).find("option:selected").attr("value");var aj=y("#citySelect_"+id).find("option:selected").attr("value");var ao=y("#countySelect_"+id).find("option:selected").attr("value");var W=y("#proSelect_"+id).find("option:selected").attr("_val");var Y=y("#citySelect_"+id).find("option:selected").attr("_val");var Z=y("#countySelect_"+id).find("option:selected").attr("_val");if(!q){ab=y("#proNewSelect_"+id).find(".f-select-text").attr("value");aj=y("#cityNewSelect_"+id).find(".f-select-text").attr("value");ao=y("#countyNewSelect_"+id).find(".f-select-text").attr("value");W=y("#proNewSelect_"+id).find(".f-select-text").text();Y=y("#cityNewSelect_"+id).find(".f-select-text").text();Z=y("#countyNewSelect_"+id).find(".f-select-text").text()}if(must&&(ab=="-1"||aj=="-1")){G(Fai.format(LS.siteFormSubmitInputIsEmpty,Fai.encodeHtml(name)));ag=false;return false}W=ab==-1?"":W;Y=aj==-1?"":Y;Z=ao==-1?"":Z;tmpItemContentList.val=W+Y+Z}}}}}}}}}}}}ac.push(tmpItemContentList)}var ae=y("#bookingVolidationCode").val();if(l.validation&&ae==""){G(Fai.format(LS.siteFormSubmitInputIsEmpty,LS.loginDialogCaptcha));ag=false;return false}if(!ag){return false}G(LS.siteFormSubmitIng);if((typeof(y(k).data("bookingHasCommit"))=="undefined")||y(k).data("bookingHasCommit")==false){y(k).data("bookingHasCommit",true);y.ajax({type:"post",url:"ajax/booking_h.jsp",data:"cmd=add&pid="+l.pid+"&validateCode="+ae+"&submitContentList="+Fai.encodeUrl(y.toJSON(ac))+"&tmpFileList="+Fai.encodeUrl(y.toJSON(ap)),error:function(){y(k).data("bookingHasCommit",false);J(false)},success:function(at){y(k).data("bookingHasCommit",false);at=y.parseJSON(at);if(at.success){var au=o[l.Def_BookingSubmit_JUMP_URL];setTimeout(function(){au.lt==1?(function(){Fai.top.location.href=o.jumpToUrl})():Fai.top.location.reload();I()},2500);J(true,"",2000)}else{if(at.rt==-401){J(false,at.msg);y(".validateInputAndCode #bookingVolidationCode").val("");y(".validateInputAndCode .voteCodePic").trigger("click")}else{if(at.rt==-4){J(false,LS.bookingSubmitFullTips)}else{if(at.rt==-7){J(false,LS.siteImgFull)}else{if(at.rt==-2){J(false,LS.argsError)}else{J(false,LS.memberLoginError)}}}}}}})}}function G(U){var T=E.dom;T.bookingPanelMsg.html(U);var S=T.content.width(),R=T.bookingPanelMsg.width();T.bookingPanelMsg.css("left",(S-R)/2+"px");T.bookingPanelMsg.show();setTimeout(function(){T.bookingPanelMsg.hide()},3000)}function J(S,V,R){var T={htmlContent:Site.getDialogContent(false,Fai.format(V?V:LS.siteFormSubmitError)),width:205,height:78};if(S){var U=[];U.push("<div class='booking-sweet-alert' style='margin-top: 50px;'>");U.push("	<div class='sa-icon sa-success animate'>");U.push("		<span class='sa-line sa-tip animateSuccessTip'></span>");U.push("		<span class='sa-line sa-long animateSuccessLong'></span>");U.push("		<div class='sa-placeholder'></div>");U.push("		<div class='sa-fix'></div>");U.push("	</div>");U.push("	<div class='submitSuccessTitle'>"+LS.siteFormSubmitOk+"</div>");U.push("</div>");T={htmlContent:U.join(""),width:500,height:320,autoClose:R||0}}Site.popupBox(T)}function P(){if(q){y(".proSelect").change(function(){var R=y(this).attr("_contentId");var T=y(this).val();var U=[];if(H){U=site_cityUtil.getCities(T)}else{U=site_cityUtil.getCitiesEn(T)}var S=[];S.push("<option _val='-1' value='-1'>"+l.siteFormPleaseSelect+"</option>");y.each(U,function(V,W){if(H){S.push("<option _val='"+W.name+"' value='"+W.id+"'>"+site_cityUtil.simpleCityNameStr(W.name)+"</option>")}else{S.push("<option _val='"+W.name+"' value='"+W.id+"'>"+site_cityUtil.simpleCityNameStrEn(W.name)+"</option>")}});y("#citySelect_"+R).removeAttr("disabled").html(S.join(""))});y(".citySelect").change(function(){var S=y(this).attr("_contentId");var U=y(this).val();var R=[];if(H){R=site_cityUtil.getCounty(U)}else{R=site_cityUtil.getCountyEn(U)}var T=[];T.push("<option _val='-1' value='-1'>"+l.siteFormPleaseSelect+"</option>");y.each(R,function(V,W){if(H){T.push("<option _val='"+W.name+"' value='"+W.id+"'>"+site_cityUtil.simpleCityNameStr(W.name)+"</option>")}else{T.push("<option _val='"+W.name+"' value='"+W.id+"'>"+site_cityUtil.simpleCityNameStrEn(W.name)+"</option>")}});y("#countySelect_"+S).removeAttr("disabled").html(T.join(""))})}}function B(){if(q){return}var S=[];y.each(l.mobileCtNameList,function(T,U){S.push({content:(U.ctShowName+U.ctCode),value:U.ctName})});var R=0;y(S).each(function(T,U){if(U.value==l.memberMobileCt){R=T}});y.each(l.contentList,function(X,U){var T=U.id,Z=U.type,aa=U.input;if(Z==l.Def_ContentList_Type_PHONE&&U.openAreaCode){b({container:y("#phoneNewSelect_"+T),widgetClass:"phoneCode",id:"phoneNewSelect",checkIndex:(U.sys?R:0),width:120,selectList:S,onchange:function(){}})}else{if(Z==l.Def_ContentList_Type_DROPDOWN){var V=[];var Y=aa.split("\n");y.each(Y,function(ad,ae){V.push({content:ae,value:ae})});b({container:y("#dropDownNewSelect_"+T),widgetClass:"drowDown",id:"dropDownNewSelect_",checkIndex:0,width:120,selectList:V,onchange:function(){}})}else{if(Z==l.Def_ContentList_Type_ADDRESS){var ab;if(H){ab=site_cityUtil.getProvince()}else{ab=site_cityUtil.getProvinceEn()}var W=[];W.push({content:l.siteFormPleaseSelect,value:-1});y.each(ab,function(ad,ae){W.push({content:ae.name,value:ae.id})});var ac=b({container:y("#proNewSelect_"+T),widgetClass:"proAddr",id:"proNewSelect",checkIndex:0,width:120,selectList:W,onchange:function(){y("#countyNewSelect_"+T).empty();b({container:y("#countyNewSelect_"+T),widgetClass:"cityAddr",id:"countyNewSelect_",checkIndex:0,width:120,selectList:[{content:l.siteFormPleaseSelect,value:-1}],enable:true,onchange:function(){}});var ag;var af=ac.getValue();if(H){ag=site_cityUtil.getCities(af)}else{ag=site_cityUtil.getCitiesEn(af)}var ad=[];ad.push({content:l.siteFormPleaseSelect,value:-1});y.each(ag,function(ah,ai){ad.push({content:ai.name,value:ai.id})});y("#cityNewSelect_"+T).empty();var ae=b({container:y("#cityNewSelect_"+T),widgetClass:"cityAddr",id:"cityNewSelect",checkIndex:0,width:120,selectList:ad,onchange:function(){var ah;var aj=ae.getValue();if(H){ah=site_cityUtil.getCounty(aj)}else{ah=site_cityUtil.getCountyEn(aj)}var ai=[];ai.push({content:l.siteFormPleaseSelect,value:-1});y.each(ah,function(ak,al){ai.push({content:al.name,value:al.id})});if(U.openMunicipalCode){y("#countyNewSelect_"+T).empty();b({container:y("#countyNewSelect_"+T),widgetClass:"cityAddr",id:"countyNewSelect_",checkIndex:0,width:120,selectList:ai,onchange:function(){}})}}})}});b({container:y("#cityNewSelect_"+T),widgetClass:"cityAddr",id:"cityNewSelect",checkIndex:0,width:120,selectList:[{content:l.siteFormPleaseSelect,value:-1}],enable:true,onchange:function(){}});b({container:y("#countyNewSelect_"+T),widgetClass:"cityAddr",id:"countyNewSelect_",checkIndex:0,width:120,selectList:[{content:l.siteFormPleaseSelect,value:-1}],enable:true,onchange:function(){}})}}}})}function N(){if(q){return}y(k).off("click.nradio").on("click.nradio",".jz-radio",function(){var R=y(this).attr("inputName");y(".R_"+R).removeClass("jz-radio-checked");y(this).find("input[name="+R+"]").attr("checked",false);y(this).addClass("jz-radio-checked");y(this).find(".jz-radio-input").attr("checked",true)})}function m(){N();P();B();Site.siteFormTimeBtn(s);if(Fai.top._manageMode){y(".fileUploadBtn").click(function(){G("当前为管理态状态，文件上传无效")});y("#bookingSubmitBtn .s_ibutton").click(function(){G("当前为管理态状态，提交无效")});C()}else{y.each(f,function(S,R){z(R)});y("#bookingSubmitBtn .s_ibutton").click(function(){p()})}if(Fai.top.$("#fk-bookingSubmitPanel f-innerContent>.mCustomScrollbar").length<1){Fai.top.$("#fk-bookingSubmitPanel .tableWrap").mCustomScrollbar({theme:"fk-gray",advanced:{updateOnContentResize:true},axis:"y"})}}function C(){var S=E.dom.content;if(S.length<0){return}if(E.dom.content.find(".J_resizableTip").length>0){return}var R="<div class='ui-resizable-handle ui-resizable-e funPanelResizeHandle' _dir='0' style='z-index: 1000;'></div><div class='ui-resizable-handle ui-resizable-w funPanelResizeHandle' _dir='1' style='z-index: 1000;'></div><div class='ui-resizable-handle ui-resizable-s funPanelResizeHandle' _dir='2' style='z-index: 1000;'></div><div class='ui-resizable-handle ui-resizable-n funPanelResizeHandle' _dir='3' style='z-index: 1000;'></div>";S.append(y(R));S.append("<a href='javascript:;' class='J_resizableTip ui-resizable-cancelTip fk-resizable-cancelTip "+(x==L&&c==r?"J_resizableTipHide":"")+"' id='J_resizableTip_44' style='z-index:9999;' _faiscoTip='还原默认宽度和高度'></a>");E.dom.content.find(".J_resizableTip").click(function(){var V=(Fai.top.$("body").width()-c)/2;V=V<0?0:V;var U=(Fai.top.$("body").height()-x)/2;U=U<0?0:U;E.dom.content.css({width:+c,height:x,left:V,top:U});E.dom.content.find("#tableWrap").css("height",(x-110));y(this).hide();T(c,x)});S.children(".ui-resizable-handle").off("mousedown.pzresize").on("mousedown.pzresize",function(W){if(W.button!=0){return}var V={clientX:W.clientX,clientY:W.clientY},U=S.width();startHeight=S.height();handle=y(this),documentElem=y(document);direction=parseInt(handle.attr("_dir"));documentElem.off("mousemove.pzresize").on("mousemove.pzresize",function(ab){y("#fk-moduleToolbar44").hide();E.dom.content.find(".J_resizableTip").hide();var X={clientX:ab.clientX,clientY:ab.clientY},ac=0,aa=S.width();resizeHeight=S.height();switch(direction){case 0:ac=parseInt(X.clientX-V.clientX);aa=U+(ac*2);break;case 1:ac=parseInt(X.clientX-V.clientX);aa=U-(ac*2);break;case 2:ac=parseInt(X.clientY-V.clientY);resizeHeight=startHeight+(ac*2);break;case 3:ac=parseInt(X.clientY-V.clientY);resizeHeight=startHeight-(ac*2);break;default:}aa=aa<450?450:aa;resizeHeight=resizeHeight<100?100:resizeHeight;if(direction<2){var Z=(Fai.top.$("body").width()-aa)/2;Z=Z<=20?20:Z;if(Z>20){S.css("width",aa);E.dom.content.css("left",Z)}}else{if(direction<4){var Y=(Fai.top.$("body").height()-resizeHeight)/2;Y=Y<=20?20:Y;if(Y>20){S.css("height",resizeHeight);E.dom.content.find("#tableWrap").css("height",(resizeHeight-110));E.dom.content.css("top",Y)}}}});documentElem.off("selectstart.pzsel").on("selectstart.pzsel",function(){return false});documentElem.off("mouseup.pzresize").on("mouseup.pzresize",function(X){documentElem.off("mousemove.pzresize").off("mouseup.pzresize").off("selectstart.pzsel");T(S.width(),S.height())})});function T(V,U){var W={};W.w=V;W.h=U;y.ajax({type:"get",cache:false,url:Site.genAjaxUrl("module_h.jsp?")+"cmd=set&id=44&style=104&pattern="+Fai.encodeUrl(JSON.stringify(W)),error:function(){Fai.ing("服务繁忙，请稍候重试",false)},success:function(Y){var X=jQuery.parseJSON(Y);if(X.success){r=V;L=U;if(x==L&&c==r){E.dom.content.find(".J_resizableTip").addClass("J_resizableTipHide")}else{E.dom.content.find(".J_resizableTip").removeClass("J_resizableTipHide")}}else{Fai.ing(X.msg,false)}}})}}function e(){var S=E.dom,R=S.panel,T=S.panelBtn;T.close.click(function(){I()});S.contentBg.click(function(){I()});S.panel.on("mousewheel DOMMouseScroll",function(U){return false})}function A(R){var S=E.dom;S.panel=Fai.top.$("#fk-bookingSubmitPanel");S.content=S.panel.find(k);S.contentBg=S.panel.find(".J_contentBg");S.bookingPanelMsg=S.panel.find("#bookingPanelMsg");S.innerContent=S.panel.find("#f-innerContent");S.tableWrap=S.panel.find("#tableWrap");S.panelBtn={};S.panelBtn.close=S.panel.find(".J_close");if(typeof R.func=="function"){setTimeout(function(){R.func.apply(E,arguments)},30)}}function j(){M({func:function(){var R=E.dom;if(R.panel&&R.panel.length>0){if(R.panel.is(":hidden")){R.panel.show()}}else{Fai.top.$("#fk-bookingSubmitPanel").show()}}});if(Fai.top._manageMode&&w&&w.length>0){jzUtils.run({name:"moduleEditTool.init",callMethod:true},{id:44,isDialog:true,toolList:w})}}function I(){F();D=0;Fai.top.$("#fk-bookingSubmitPanel").find(".J_content").trigger("mouseleave.moduleEdit").end();var R=document.getElementById("fk-bookingSubmitPanel");if(R!=null){R.parentNode.removeChild(R)}}function F(){K="";w=[];s=[];f=[];l={}}E.init=function(R){I();var S=JSON.parse(R);D=S.pid;L=L==0?S.panelHeight:L;r=r==0?S.panelWidth:r;Fai.top.$("body").append(v().join(""));A({func:e});Q()};E.refresh=function(){E.dom.innerContent.empty();F();Q()};function M(R){if(Fai.top.$("link[href='"+K+"']").length<1&&y.trim(K).length>0){Site.demandLoadCss(K,function(){if(typeof R.func=="function"){R.func.apply(E,arguments)}})}else{if(typeof R.func=="function"){R.func.apply(E,arguments)}}}})(jQuery,Site.bookingSubmitPanel);